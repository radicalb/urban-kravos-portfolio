{"ast":null,"code":"import _classCallCheck from\"C:\\\\Users\\\\SpelaRK\\\\js_programming\\\\ReactJS\\\\urban-kravos\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\SpelaRK\\\\js_programming\\\\ReactJS\\\\urban-kravos\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"C:\\\\Users\\\\SpelaRK\\\\js_programming\\\\ReactJS\\\\urban-kravos\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"C:\\\\Users\\\\SpelaRK\\\\js_programming\\\\ReactJS\\\\urban-kravos\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";import _inherits from\"C:\\\\Users\\\\SpelaRK\\\\js_programming\\\\ReactJS\\\\urban-kravos\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";// withAuth.jsx\nimport React,{Component}from'react';import{Redirect}from'react-router-dom';export default function withAuth(ComponentToProtect,redirectTo){return(/*#__PURE__*/function(_Component){_inherits(_class,_Component);function _class(){var _this;_classCallCheck(this,_class);_this=_possibleConstructorReturn(this,_getPrototypeOf(_class).call(this));_this.state={loading:true,redirect:false};return _this;}_createClass(_class,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;fetch('/api/users/checkToken').then(function(res){console.log(res);if(res.status===200){_this2.setState({loading:false});}else{var error=new Error(res.error);throw error;}}).catch(function(err){console.error(err);_this2.setState({loading:false,redirect:true});});}},{key:\"render\",value:function render(){var _this$state=this.state,loading=_this$state.loading,redirect=_this$state.redirect;if(loading){return null;}if(redirect){var loginUrl='/login'+redirectTo;return React.createElement(Redirect,{to:loginUrl});}return React.createElement(React.Fragment,null,React.createElement(ComponentToProtect,this.props));}}]);return _class;}(Component));}","map":{"version":3,"sources":["C:/Users/SpelaRK/js_programming/ReactJS/urban-kravos/client/src/components/withAuth.jsx"],"names":["React","Component","Redirect","withAuth","ComponentToProtect","redirectTo","state","loading","redirect","fetch","then","res","console","log","status","setState","error","Error","catch","err","loginUrl","props"],"mappings":"iwBAAA;AACA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,OAASC,QAAT,KAAyB,kBAAzB,CAEA,cAAe,SAASC,CAAAA,QAAT,CAAkBC,kBAAlB,CAAsCC,UAAtC,CAAkD,CAC/D,sEACE,iBAAc,wCACZ,0EACA,MAAKC,KAAL,CAAa,CACXC,OAAO,CAAE,IADE,CAEXC,QAAQ,CAAE,KAFC,CAAb,CAFY,aAMb,CAPH,gFAQsB,iBAClBC,KAAK,CAAC,uBAAD,CAAL,CACGC,IADH,CACQ,SAAAC,GAAG,CAAI,CACXC,OAAO,CAACC,GAAR,CAAYF,GAAZ,EACA,GAAIA,GAAG,CAACG,MAAJ,GAAe,GAAnB,CAAwB,CACtB,MAAI,CAACC,QAAL,CAAc,CAAER,OAAO,CAAE,KAAX,CAAd,EACD,CAFD,IAEO,CACL,GAAMS,CAAAA,KAAK,CAAG,GAAIC,CAAAA,KAAJ,CAAUN,GAAG,CAACK,KAAd,CAAd,CACA,KAAMA,CAAAA,KAAN,CACD,CACF,CATH,EAUGE,KAVH,CAUS,SAAAC,GAAG,CAAI,CACZP,OAAO,CAACI,KAAR,CAAcG,GAAd,EACA,MAAI,CAACJ,QAAL,CAAc,CAAER,OAAO,CAAE,KAAX,CAAkBC,QAAQ,CAAE,IAA5B,CAAd,EACD,CAbH,EAcD,CAvBH,uCAwBW,iBACuB,KAAKF,KAD5B,CACCC,OADD,aACCA,OADD,CACUC,QADV,aACUA,QADV,CAEP,GAAID,OAAJ,CAAa,CACX,MAAO,KAAP,CACD,CACD,GAAIC,QAAJ,CAAc,CACZ,GAAIY,CAAAA,QAAQ,CAAG,SAAWf,UAA1B,CACA,MAAO,qBAAC,QAAD,EAAU,EAAE,CAAEe,QAAd,EAAP,CACD,CACD,MACE,qBAAC,KAAD,CAAO,QAAP,MACE,oBAAC,kBAAD,CAAwB,KAAKC,KAA7B,CADF,CADF,CAKD,CAtCH,oBAAqBpB,SAArB,GAwCD","sourcesContent":["// withAuth.jsx\r\nimport React, { Component } from 'react';\r\nimport { Redirect } from 'react-router-dom';\r\n\r\nexport default function withAuth(ComponentToProtect, redirectTo) {\r\n  return class extends Component {\r\n    constructor() {\r\n      super();\r\n      this.state = {\r\n        loading: true,\r\n        redirect: false\r\n      };\r\n    }\r\n    componentDidMount() {\r\n      fetch('/api/users/checkToken')\r\n        .then(res => {\r\n          console.log(res);\r\n          if (res.status === 200) {\r\n            this.setState({ loading: false });\r\n          } else {\r\n            const error = new Error(res.error);\r\n            throw error;\r\n          }\r\n        })\r\n        .catch(err => {\r\n          console.error(err);\r\n          this.setState({ loading: false, redirect: true });\r\n        });\r\n    }\r\n    render() {\r\n      const { loading, redirect } = this.state;\r\n      if (loading) {\r\n        return null;\r\n      }\r\n      if (redirect) {\r\n        let loginUrl = '/login' + redirectTo;\r\n        return <Redirect to={loginUrl} />;\r\n      }\r\n      return (\r\n        <React.Fragment>\r\n          <ComponentToProtect {...this.props} />\r\n        </React.Fragment>\r\n      );\r\n    }\r\n  };\r\n}\r\n"]},"metadata":{},"sourceType":"module"}